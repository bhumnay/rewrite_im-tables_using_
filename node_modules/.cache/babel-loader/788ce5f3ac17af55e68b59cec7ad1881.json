{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getSortData = getSortData;\nexports[\"default\"] = useFilterSorter;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\n\nvar _useColumns = require(\"rc-table/lib/hooks/useColumns\");\n\nvar _CaretDownOutlined = _interopRequireDefault(require(\"@ant-design/icons/CaretDownOutlined\"));\n\nvar _CaretUpOutlined = _interopRequireDefault(require(\"@ant-design/icons/CaretUpOutlined\"));\n\nvar _util = require(\"../util\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj[\"default\"] = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction getMultiplePriority(column) {\n  if (_typeof(column.sorter) === 'object' && typeof column.sorter.multiple === 'number') {\n    return column.sorter.multiple;\n  }\n\n  return false;\n}\n\nfunction getSortFunction(sorter) {\n  if (typeof sorter === 'function') {\n    return sorter;\n  }\n\n  if (sorter && _typeof(sorter) === 'object' && sorter.compare) {\n    return sorter.compare;\n  }\n\n  return false;\n}\n\nfunction nextSortDirection(sortDirections, current) {\n  if (!current) {\n    return sortDirections[0];\n  }\n\n  return sortDirections[sortDirections.indexOf(current) + 1];\n}\n\nfunction collectSortStates(columns, init, pos) {\n  var sortStates = [];\n  (columns || []).forEach(function (column, index) {\n    var columnPos = (0, _util.getColumnPos)(index, pos);\n\n    if ('children' in column) {\n      sortStates = [].concat(_toConsumableArray(sortStates), _toConsumableArray(collectSortStates(column.children, init, columnPos)));\n    } else if (column.sorter) {\n      if ('sortOrder' in column) {\n        // Controlled\n        sortStates.push({\n          column: column,\n          key: (0, _util.getColumnKey)(column, columnPos),\n          multiplePriority: getMultiplePriority(column),\n          sortOrder: column.sortOrder\n        });\n      } else if (init && column.defaultSortOrder) {\n        // Default sorter\n        sortStates.push({\n          column: column,\n          key: (0, _util.getColumnKey)(column, columnPos),\n          multiplePriority: getMultiplePriority(column),\n          sortOrder: column.defaultSortOrder\n        });\n      }\n    }\n  });\n  return sortStates;\n}\n\nfunction injectSorter(prefixCls, columns, sorterSates, triggerSorter, defaultSortDirections, pos) {\n  return (columns || []).map(function (column, index) {\n    var columnPos = (0, _util.getColumnPos)(index, pos);\n    var newColumn = column;\n\n    if (newColumn.sorter) {\n      var sortDirections = newColumn.sortDirections || defaultSortDirections;\n      var columnKey = (0, _util.getColumnKey)(newColumn, columnPos);\n      var sorterState = sorterSates.find(function (_ref) {\n        var key = _ref.key;\n        return key === columnKey;\n      });\n      var sorterOrder = sorterState ? sorterState.sortOrder : null;\n      var upNode = sortDirections.includes('ascend') && React.createElement(_CaretUpOutlined[\"default\"], {\n        className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter-up\"), {\n          active: sorterOrder === 'ascend'\n        })\n      });\n      var downNode = sortDirections.includes('descend') && React.createElement(_CaretDownOutlined[\"default\"], {\n        className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter-down\"), {\n          active: sorterOrder === 'descend'\n        })\n      });\n      newColumn = _extends(_extends({}, newColumn), {\n        className: (0, _classnames[\"default\"])(newColumn.className, _defineProperty({}, \"\".concat(prefixCls, \"-column-sort\"), sorterOrder)),\n        title: function title(renderProps) {\n          return React.createElement(\"div\", {\n            className: \"\".concat(prefixCls, \"-column-sorters\")\n          }, React.createElement(\"span\", null, (0, _util.renderColumnTitle)(column.title, renderProps)), React.createElement(\"span\", {\n            className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter\"), _defineProperty({}, \"\".concat(prefixCls, \"-column-sorter-full\"), upNode && downNode))\n          }, React.createElement(\"span\", {\n            className: \"\".concat(prefixCls, \"-column-sorter-inner\")\n          }, upNode, downNode)));\n        },\n        onHeaderCell: function onHeaderCell(col) {\n          var cell = column.onHeaderCell && column.onHeaderCell(col) || {};\n          var originOnClick = cell.onClick;\n\n          cell.onClick = function (event) {\n            triggerSorter({\n              column: column,\n              key: columnKey,\n              sortOrder: nextSortDirection(sortDirections, sorterOrder),\n              multiplePriority: getMultiplePriority(column)\n            });\n\n            if (originOnClick) {\n              originOnClick(event);\n            }\n          };\n\n          cell.className = (0, _classnames[\"default\"])(cell.className, \"\".concat(prefixCls, \"-column-has-sorters\"));\n          return cell;\n        }\n      });\n    }\n\n    if ('children' in newColumn) {\n      newColumn = _extends(_extends({}, newColumn), {\n        children: injectSorter(prefixCls, newColumn.children, sorterSates, triggerSorter, defaultSortDirections, columnPos)\n      });\n    }\n\n    return newColumn;\n  });\n}\n\nfunction stateToInfo(sorterStates) {\n  var column = sorterStates.column,\n      sortOrder = sorterStates.sortOrder;\n  return {\n    column: column,\n    order: sortOrder,\n    field: column.dataIndex,\n    columnKey: column.key\n  };\n}\n\nfunction generateSorterInfo(sorterStates) {\n  var list = sorterStates.filter(function (_ref2) {\n    var sortOrder = _ref2.sortOrder;\n    return sortOrder;\n  }).map(stateToInfo); // =========== Legacy compatible support ===========\n  // https://github.com/ant-design/ant-design/pull/19226\n\n  if (list.length === 0 && sorterStates.length) {\n    return _extends(_extends({}, stateToInfo(sorterStates[0])), {\n      column: undefined\n    });\n  }\n\n  if (list.length <= 1) {\n    return list[0] || {};\n  }\n\n  return list;\n}\n\nfunction getSortData(data, sortStates, childrenColumnName) {\n  var innerSorterStates = sortStates.slice().sort(function (a, b) {\n    return b.multiplePriority - a.multiplePriority;\n  });\n  var cloneData = data.slice();\n  var runningSorters = innerSorterStates.filter(function (_ref3) {\n    var sorter = _ref3.column.sorter,\n        sortOrder = _ref3.sortOrder;\n    return getSortFunction(sorter) && sortOrder;\n  }); // Skip if no sorter needed\n\n  if (!runningSorters.length) {\n    return cloneData;\n  }\n\n  return cloneData.sort(function (record1, record2) {\n    for (var i = 0; i < runningSorters.length; i += 1) {\n      var sorterState = runningSorters[i];\n      var sorter = sorterState.column.sorter,\n          sortOrder = sorterState.sortOrder;\n      var compareFn = getSortFunction(sorter);\n\n      if (compareFn && sortOrder) {\n        var compareResult = compareFn(record1, record2, sortOrder);\n\n        if (compareResult !== 0) {\n          return sortOrder === 'ascend' ? compareResult : -compareResult;\n        }\n      }\n    }\n\n    return 0;\n  }).map(function (record) {\n    var subRecords = record[childrenColumnName];\n\n    if (subRecords) {\n      return _extends(_extends({}, record), _defineProperty({}, childrenColumnName, getSortData(subRecords, sortStates, childrenColumnName)));\n    }\n\n    return record;\n  });\n}\n\nfunction useFilterSorter(_ref4) {\n  var prefixCls = _ref4.prefixCls,\n      columns = _ref4.columns,\n      children = _ref4.children,\n      onSorterChange = _ref4.onSorterChange,\n      sortDirections = _ref4.sortDirections;\n  var mergedColumns = React.useMemo(function () {\n    return columns || (0, _useColumns.convertChildrenToColumns)(children);\n  }, [children, columns]);\n\n  var _React$useState = React.useState(collectSortStates(mergedColumns, true)),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      sortStates = _React$useState2[0],\n      setSortStates = _React$useState2[1];\n\n  var mergedSorterStates = React.useMemo(function () {\n    var validate = true;\n    var collectedStates = collectSortStates(mergedColumns, false); // Return if not controlled\n\n    if (!collectedStates.length) {\n      return sortStates;\n    }\n\n    var validateStates = [];\n\n    function patchStates(state) {\n      if (validate) {\n        validateStates.push(state);\n      } else {\n        validateStates.push(_extends(_extends({}, state), {\n          sortOrder: null\n        }));\n      }\n    }\n\n    var multipleMode = null;\n    collectedStates.forEach(function (state) {\n      if (multipleMode === null) {\n        patchStates(state);\n\n        if (state.sortOrder) {\n          if (state.multiplePriority === false) {\n            validate = false;\n          } else {\n            multipleMode = true;\n          }\n        }\n      } else if (multipleMode && state.multiplePriority !== false) {\n        patchStates(state);\n      } else {\n        validate = false;\n        patchStates(state);\n      }\n    });\n    return validateStates;\n  }, [mergedColumns, sortStates]); // Get render columns title required props\n\n  var columnTitleSorterProps = React.useMemo(function () {\n    var sortColumns = mergedSorterStates.map(function (_ref5) {\n      var column = _ref5.column,\n          sortOrder = _ref5.sortOrder;\n      return {\n        column: column,\n        order: sortOrder\n      };\n    });\n    return {\n      sortColumns: sortColumns,\n      // Legacy\n      sortColumn: sortColumns[0] && sortColumns[0].column,\n      sortOrder: sortColumns[0] && sortColumns[0].order\n    };\n  }, [mergedSorterStates]);\n\n  function triggerSorter(sortState) {\n    var newSorterStates;\n\n    if (sortState.multiplePriority === false || !mergedSorterStates.length || mergedSorterStates[0].multiplePriority === false) {\n      newSorterStates = [sortState];\n    } else {\n      newSorterStates = [].concat(_toConsumableArray(mergedSorterStates.filter(function (_ref6) {\n        var key = _ref6.key;\n        return key !== sortState.key;\n      })), [sortState]);\n    }\n\n    setSortStates(newSorterStates);\n    onSorterChange(generateSorterInfo(newSorterStates), newSorterStates);\n  }\n\n  var transformColumns = function transformColumns(innerColumns) {\n    return injectSorter(prefixCls, innerColumns, mergedSorterStates, triggerSorter, sortDirections);\n  };\n\n  var getSorters = function getSorters() {\n    return generateSorterInfo(mergedSorterStates);\n  };\n\n  return [transformColumns, mergedSorterStates, columnTitleSorterProps, getSorters];\n}","map":{"version":3,"sources":["/home/bhumika/app1/node_modules/antd/lib/table/hooks/useSorter.js"],"names":["Object","defineProperty","exports","value","getSortData","useFilterSorter","React","_interopRequireWildcard","require","_classnames","_interopRequireDefault","_useColumns","_CaretDownOutlined","_CaretUpOutlined","_util","obj","__esModule","_getRequireWildcardCache","WeakMap","cache","_typeof","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","TypeError","Symbol","iterator","toString","_arr","_n","_d","_e","undefined","_i","_s","next","done","push","length","err","Array","isArray","_defineProperty","enumerable","configurable","writable","_extends","assign","target","arguments","source","apply","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","iter","from","arr2","constructor","getMultiplePriority","column","sorter","multiple","getSortFunction","compare","nextSortDirection","sortDirections","current","indexOf","collectSortStates","columns","init","pos","sortStates","forEach","index","columnPos","getColumnPos","concat","children","getColumnKey","multiplePriority","sortOrder","defaultSortOrder","injectSorter","prefixCls","sorterSates","triggerSorter","defaultSortDirections","map","newColumn","columnKey","sorterState","find","_ref","sorterOrder","upNode","includes","createElement","className","active","downNode","title","renderProps","renderColumnTitle","onHeaderCell","col","cell","originOnClick","onClick","event","stateToInfo","sorterStates","order","field","dataIndex","generateSorterInfo","list","filter","_ref2","data","childrenColumnName","innerSorterStates","slice","sort","a","b","cloneData","runningSorters","_ref3","record1","record2","compareFn","compareResult","record","subRecords","_ref4","onSorterChange","mergedColumns","useMemo","convertChildrenToColumns","_React$useState","useState","_React$useState2","setSortStates","mergedSorterStates","validate","collectedStates","validateStates","patchStates","state","multipleMode","columnTitleSorterProps","sortColumns","_ref5","sortColumn","sortState","newSorterStates","_ref6","transformColumns","innerColumns","getSorters"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getSortData = getSortData;\nexports[\"default\"] = useFilterSorter;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\n\nvar _useColumns = require(\"rc-table/lib/hooks/useColumns\");\n\nvar _CaretDownOutlined = _interopRequireDefault(require(\"@ant-design/icons/CaretDownOutlined\"));\n\nvar _CaretUpOutlined = _interopRequireDefault(require(\"@ant-design/icons/CaretUpOutlined\"));\n\nvar _util = require(\"../util\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction getMultiplePriority(column) {\n  if (_typeof(column.sorter) === 'object' && typeof column.sorter.multiple === 'number') {\n    return column.sorter.multiple;\n  }\n\n  return false;\n}\n\nfunction getSortFunction(sorter) {\n  if (typeof sorter === 'function') {\n    return sorter;\n  }\n\n  if (sorter && _typeof(sorter) === 'object' && sorter.compare) {\n    return sorter.compare;\n  }\n\n  return false;\n}\n\nfunction nextSortDirection(sortDirections, current) {\n  if (!current) {\n    return sortDirections[0];\n  }\n\n  return sortDirections[sortDirections.indexOf(current) + 1];\n}\n\nfunction collectSortStates(columns, init, pos) {\n  var sortStates = [];\n  (columns || []).forEach(function (column, index) {\n    var columnPos = (0, _util.getColumnPos)(index, pos);\n\n    if ('children' in column) {\n      sortStates = [].concat(_toConsumableArray(sortStates), _toConsumableArray(collectSortStates(column.children, init, columnPos)));\n    } else if (column.sorter) {\n      if ('sortOrder' in column) {\n        // Controlled\n        sortStates.push({\n          column: column,\n          key: (0, _util.getColumnKey)(column, columnPos),\n          multiplePriority: getMultiplePriority(column),\n          sortOrder: column.sortOrder\n        });\n      } else if (init && column.defaultSortOrder) {\n        // Default sorter\n        sortStates.push({\n          column: column,\n          key: (0, _util.getColumnKey)(column, columnPos),\n          multiplePriority: getMultiplePriority(column),\n          sortOrder: column.defaultSortOrder\n        });\n      }\n    }\n  });\n  return sortStates;\n}\n\nfunction injectSorter(prefixCls, columns, sorterSates, triggerSorter, defaultSortDirections, pos) {\n  return (columns || []).map(function (column, index) {\n    var columnPos = (0, _util.getColumnPos)(index, pos);\n    var newColumn = column;\n\n    if (newColumn.sorter) {\n      var sortDirections = newColumn.sortDirections || defaultSortDirections;\n      var columnKey = (0, _util.getColumnKey)(newColumn, columnPos);\n      var sorterState = sorterSates.find(function (_ref) {\n        var key = _ref.key;\n        return key === columnKey;\n      });\n      var sorterOrder = sorterState ? sorterState.sortOrder : null;\n      var upNode = sortDirections.includes('ascend') && React.createElement(_CaretUpOutlined[\"default\"], {\n        className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter-up\"), {\n          active: sorterOrder === 'ascend'\n        })\n      });\n      var downNode = sortDirections.includes('descend') && React.createElement(_CaretDownOutlined[\"default\"], {\n        className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter-down\"), {\n          active: sorterOrder === 'descend'\n        })\n      });\n      newColumn = _extends(_extends({}, newColumn), {\n        className: (0, _classnames[\"default\"])(newColumn.className, _defineProperty({}, \"\".concat(prefixCls, \"-column-sort\"), sorterOrder)),\n        title: function title(renderProps) {\n          return React.createElement(\"div\", {\n            className: \"\".concat(prefixCls, \"-column-sorters\")\n          }, React.createElement(\"span\", null, (0, _util.renderColumnTitle)(column.title, renderProps)), React.createElement(\"span\", {\n            className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-column-sorter\"), _defineProperty({}, \"\".concat(prefixCls, \"-column-sorter-full\"), upNode && downNode))\n          }, React.createElement(\"span\", {\n            className: \"\".concat(prefixCls, \"-column-sorter-inner\")\n          }, upNode, downNode)));\n        },\n        onHeaderCell: function onHeaderCell(col) {\n          var cell = column.onHeaderCell && column.onHeaderCell(col) || {};\n          var originOnClick = cell.onClick;\n\n          cell.onClick = function (event) {\n            triggerSorter({\n              column: column,\n              key: columnKey,\n              sortOrder: nextSortDirection(sortDirections, sorterOrder),\n              multiplePriority: getMultiplePriority(column)\n            });\n\n            if (originOnClick) {\n              originOnClick(event);\n            }\n          };\n\n          cell.className = (0, _classnames[\"default\"])(cell.className, \"\".concat(prefixCls, \"-column-has-sorters\"));\n          return cell;\n        }\n      });\n    }\n\n    if ('children' in newColumn) {\n      newColumn = _extends(_extends({}, newColumn), {\n        children: injectSorter(prefixCls, newColumn.children, sorterSates, triggerSorter, defaultSortDirections, columnPos)\n      });\n    }\n\n    return newColumn;\n  });\n}\n\nfunction stateToInfo(sorterStates) {\n  var column = sorterStates.column,\n      sortOrder = sorterStates.sortOrder;\n  return {\n    column: column,\n    order: sortOrder,\n    field: column.dataIndex,\n    columnKey: column.key\n  };\n}\n\nfunction generateSorterInfo(sorterStates) {\n  var list = sorterStates.filter(function (_ref2) {\n    var sortOrder = _ref2.sortOrder;\n    return sortOrder;\n  }).map(stateToInfo); // =========== Legacy compatible support ===========\n  // https://github.com/ant-design/ant-design/pull/19226\n\n  if (list.length === 0 && sorterStates.length) {\n    return _extends(_extends({}, stateToInfo(sorterStates[0])), {\n      column: undefined\n    });\n  }\n\n  if (list.length <= 1) {\n    return list[0] || {};\n  }\n\n  return list;\n}\n\nfunction getSortData(data, sortStates, childrenColumnName) {\n  var innerSorterStates = sortStates.slice().sort(function (a, b) {\n    return b.multiplePriority - a.multiplePriority;\n  });\n  var cloneData = data.slice();\n  var runningSorters = innerSorterStates.filter(function (_ref3) {\n    var sorter = _ref3.column.sorter,\n        sortOrder = _ref3.sortOrder;\n    return getSortFunction(sorter) && sortOrder;\n  }); // Skip if no sorter needed\n\n  if (!runningSorters.length) {\n    return cloneData;\n  }\n\n  return cloneData.sort(function (record1, record2) {\n    for (var i = 0; i < runningSorters.length; i += 1) {\n      var sorterState = runningSorters[i];\n      var sorter = sorterState.column.sorter,\n          sortOrder = sorterState.sortOrder;\n      var compareFn = getSortFunction(sorter);\n\n      if (compareFn && sortOrder) {\n        var compareResult = compareFn(record1, record2, sortOrder);\n\n        if (compareResult !== 0) {\n          return sortOrder === 'ascend' ? compareResult : -compareResult;\n        }\n      }\n    }\n\n    return 0;\n  }).map(function (record) {\n    var subRecords = record[childrenColumnName];\n\n    if (subRecords) {\n      return _extends(_extends({}, record), _defineProperty({}, childrenColumnName, getSortData(subRecords, sortStates, childrenColumnName)));\n    }\n\n    return record;\n  });\n}\n\nfunction useFilterSorter(_ref4) {\n  var prefixCls = _ref4.prefixCls,\n      columns = _ref4.columns,\n      children = _ref4.children,\n      onSorterChange = _ref4.onSorterChange,\n      sortDirections = _ref4.sortDirections;\n  var mergedColumns = React.useMemo(function () {\n    return columns || (0, _useColumns.convertChildrenToColumns)(children);\n  }, [children, columns]);\n\n  var _React$useState = React.useState(collectSortStates(mergedColumns, true)),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      sortStates = _React$useState2[0],\n      setSortStates = _React$useState2[1];\n\n  var mergedSorterStates = React.useMemo(function () {\n    var validate = true;\n    var collectedStates = collectSortStates(mergedColumns, false); // Return if not controlled\n\n    if (!collectedStates.length) {\n      return sortStates;\n    }\n\n    var validateStates = [];\n\n    function patchStates(state) {\n      if (validate) {\n        validateStates.push(state);\n      } else {\n        validateStates.push(_extends(_extends({}, state), {\n          sortOrder: null\n        }));\n      }\n    }\n\n    var multipleMode = null;\n    collectedStates.forEach(function (state) {\n      if (multipleMode === null) {\n        patchStates(state);\n\n        if (state.sortOrder) {\n          if (state.multiplePriority === false) {\n            validate = false;\n          } else {\n            multipleMode = true;\n          }\n        }\n      } else if (multipleMode && state.multiplePriority !== false) {\n        patchStates(state);\n      } else {\n        validate = false;\n        patchStates(state);\n      }\n    });\n    return validateStates;\n  }, [mergedColumns, sortStates]); // Get render columns title required props\n\n  var columnTitleSorterProps = React.useMemo(function () {\n    var sortColumns = mergedSorterStates.map(function (_ref5) {\n      var column = _ref5.column,\n          sortOrder = _ref5.sortOrder;\n      return {\n        column: column,\n        order: sortOrder\n      };\n    });\n    return {\n      sortColumns: sortColumns,\n      // Legacy\n      sortColumn: sortColumns[0] && sortColumns[0].column,\n      sortOrder: sortColumns[0] && sortColumns[0].order\n    };\n  }, [mergedSorterStates]);\n\n  function triggerSorter(sortState) {\n    var newSorterStates;\n\n    if (sortState.multiplePriority === false || !mergedSorterStates.length || mergedSorterStates[0].multiplePriority === false) {\n      newSorterStates = [sortState];\n    } else {\n      newSorterStates = [].concat(_toConsumableArray(mergedSorterStates.filter(function (_ref6) {\n        var key = _ref6.key;\n        return key !== sortState.key;\n      })), [sortState]);\n    }\n\n    setSortStates(newSorterStates);\n    onSorterChange(generateSorterInfo(newSorterStates), newSorterStates);\n  }\n\n  var transformColumns = function transformColumns(innerColumns) {\n    return injectSorter(prefixCls, innerColumns, mergedSorterStates, triggerSorter, sortDirections);\n  };\n\n  var getSorters = function getSorters() {\n    return generateSorterInfo(mergedSorterStates);\n  };\n\n  return [transformColumns, mergedSorterStates, columnTitleSorterProps, getSorters];\n}"]},"metadata":{},"sourceType":"script"}